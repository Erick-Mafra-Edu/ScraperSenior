{
  "openapi": "3.1.0",
  "info": {
    "title": "Senior Documentation API",
    "description": "API OpenAPI para busca em documenta√ß√£o Senior com integra√ß√£o Meilisearch. ‚≠ê FERRAMENTA PRINCIPAL: Use /search para encontrar documentos. Use /modules para listar m√≥dulos. Use /stats para informa√ß√µes da base. Esta ferramenta cont√©m 855+ documentos t√©cnicos sobre sistemas Senior.",
    "version": "1.0.0",
    "contact": {
      "name": "Digisys",
      "url": "https://www.digisys.com.br"
    },
    "license": {
      "name": "MIT"
    }
  },
  "servers": [
    {
      "url": "http://localhost:8000",
      "description": "Servidor de desenvolvimento local"
    },
    {
      "url": "http://people-fy.com:8000",
      "description": "Servidor externo (people-fy.com)"
    },
    {
      "url": "http://senior-docs-mcp-server:8000",
      "description": "Servidor Docker interno"
    }
  ],
  "externalDocs": {
    "description": "üìñ Complete documentation and troubleshooting guide",
    "url": "file://./OPENWEBUI_COMPATIBILITY.md"
  },
  "tags": [
    {
      "name": "Sistema",
      "description": "Endpoints de sistema e sa√∫de"
    },
    {
      "name": "Busca",
      "description": "Endpoints de busca em documenta√ß√£o"
    },
    {
      "name": "M√≥dulos",
      "description": "Endpoints para gerenciar e consultar m√≥dulos"
    }
  ],
  "paths": {
    "/health": {
      "get": {
        "tags": [
          "Sistema"
        ],
        "summary": "Health Check",
        "description": "Verifica a sa√∫de do servi√ßo e conectividade com Meilisearch. Retorna status detalhado do servidor e depend√™ncias.",
        "operationId": "health_check",
        "responses": {
          "200": {
            "description": "Servi√ßo saud√°vel",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HealthResponse"
                }
              }
            }
          },
          "503": {
            "description": "Servi√ßo indispon√≠vel",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "detail": {
                      "type": "string"
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/search": {
      "post": {
        "tags": [
          "Busca"
        ],
        "summary": "üîç Buscar Documenta√ß√£o - USE ISTO PARA RESPONDER PERGUNTAS",
        "description": "‚≠ê FERRAMENTA PRINCIPAL: Busca documenta√ß√£o t√©cnica Senior para responder perguntas do usu√°rio. SEMPRE USE quando o usu√°rio perguntar sobre: como fazer algo, procedimentos, configura√ß√£o, guias, tutoriais, ou qualquer informa√ß√£o sobre sistemas Senior. Retorna documentos com t√≠tulo, m√≥dulo, conte√∫do e score de relev√¢ncia. Combine com /modules para especificar m√≥dulo se necess√°rio.",
        "operationId": "search_documentation",
        "x-openai-isConsequential": true,
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/SearchRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Busca realizada com sucesso",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/SearchResponse"
                }
              }
            }
          },
          "400": {
            "description": "Par√¢metros inv√°lidos",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "detail": {
                      "type": "string"
                    }
                  }
                }
              }
            }
          },
          "503": {
            "description": "Meilisearch indispon√≠vel",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "detail": {
                      "type": "string"
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/modules": {
      "get": {
        "tags": [
          "M√≥dulos"
        ],
        "summary": "üìö Listar Todos os M√≥dulos Dispon√≠veis",
        "description": "Retorna lista completa de m√≥dulos dispon√≠veis (RH, FINANCEIRO, TECNOLOGIA, BPM, etc) com contagem de documentos em cada um. Use para listar m√≥dulos quando usu√°rio pergunta 'quais m√≥dulos existem' ou 'qual √© a documenta√ß√£o dispon√≠vel'.",
        "operationId": "list_available_modules",
        "responses": {
          "200": {
            "description": "Lista de m√≥dulos obtida com sucesso",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ModulesResponse"
                }
              }
            }
          },
          "503": {
            "description": "Servi√ßo indispon√≠vel",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "detail": {
                      "type": "string"
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/modules/{module_name}": {
      "get": {
        "tags": [
          "M√≥dulos"
        ],
        "summary": "Obter Documenta√ß√£o do M√≥dulo",
        "description": "Retorna toda a documenta√ß√£o de um m√≥dulo espec√≠fico.",
        "operationId": "get_module_docs",
        "parameters": [
          {
            "name": "module_name",
            "in": "path",
            "required": true,
            "description": "Nome do m√≥dulo (ex: 'RH', 'Fiscal', 'Financeiro')",
            "schema": {
              "type": "string"
            },
            "example": "RH"
          }
        ],
        "responses": {
          "200": {
            "description": "Documenta√ß√£o do m√≥dulo obtida com sucesso",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ModuleDocsResponse"
                }
              }
            }
          },
          "404": {
            "description": "M√≥dulo n√£o encontrado",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "detail": {
                      "type": "string"
                    }
                  }
                }
              }
            }
          },
          "503": {
            "description": "Servi√ßo indispon√≠vel",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "detail": {
                      "type": "string"
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/stats": {
      "get": {
        "tags": [
          "Sistema"
        ],
        "summary": "üìä Obter Estat√≠sticas da Base de Dados",
        "description": "Retorna estat√≠sticas completas: total de documentos indexados (855+), n√∫mero de m√≥dulos, contagem por m√≥dulo, e status do √≠ndice. Use para responder perguntas como 'quantos documentos temos' ou 'qual √© o tamanho da base'.",
        "operationId": "get_documentation_stats",
        "responses": {
          "200": {
            "description": "Estat√≠sticas obtidas com sucesso",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/StatsResponse"
                }
              }
            }
          },
          "503": {
            "description": "Servi√ßo indispon√≠vel",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "detail": {
                      "type": "string"
                    }
                  }
                }
              }
            }
          }
        }
      }
    }
  },
  "components": {
    "schemas": {
      "SearchRequest": {
        "type": "object",
        "required": [
          "query"
        ],
        "properties": {
          "query": {
            "type": "string",
            "description": "OBRIGAT√ìRIO: Palavras-chave ou pergunta do usu√°rio (ex: 'configurar NTLM', 'como fazer backup', 'guia de implanta√ß√£o', 'erro 500'). Este √© o termo de busca mais importante - sempre preencher com as palavras-chave da pergunta.",
            "minLength": 1,
            "maxLength": 500,
            "example": "configurar autentica√ß√£o NTLM"
          },
          "module": {
            "type": "string",
            "nullable": true,
            "description": "[OPCIONAL] Filtrar por m√≥dulo espec√≠fico (RH, FINANCEIRO, TECNOLOGIA, BPM, etc). Deixar vazio para buscar em todos os m√≥dulos.",
            "example": null
          },
          "limit": {
            "type": "integer",
            "description": "N√∫mero de resultados desejados (padr√£o: 10). Use 5-10 para perguntas simples, at√© 20 para buscas complexas.",
            "minimum": 1,
            "maximum": 100,
            "default": 10
          },
          "offset": {
            "type": "integer",
            "description": "Offset para pagina√ß√£o",
            "minimum": 0,
            "default": 0
          }
        }
      },
      "DocumentResponse": {
        "type": "object",
        "required": [
          "id",
          "title",
          "module",
          "content_preview",
          "metadata"
        ],
        "properties": {
          "id": {
            "type": "string",
            "description": "ID √∫nico do documento"
          },
          "title": {
            "type": "string",
            "description": "T√≠tulo do documento"
          },
          "module": {
            "type": "string",
            "description": "M√≥dulo ao qual pertence"
          },
          "breadcrumb": {
            "type": "string",
            "nullable": true,
            "description": "Caminho hier√°rquico do documento"
          },
          "content_preview": {
            "type": "string",
            "description": "Preview do conte√∫do (primeiras 200 caracteres)"
          },
          "content": {
            "type": "string",
            "nullable": true,
            "description": "Conte√∫do completo do documento (opcional)"
          },
          "html": {
            "type": "string",
            "nullable": true,
            "description": "HTML original do documento (opcional)"
          },
          "url": {
            "type": "string",
            "nullable": true,
            "description": "URL original do documento"
          },
          "score": {
            "type": "number",
            "format": "float",
            "nullable": true,
            "description": "Score de relev√¢ncia da busca (0-100)"
          },
          "metadata": {
            "type": "object",
            "description": "Metadados adicionais",
            "additionalProperties": true
          }
        }
      },
      "SearchResponse": {
        "type": "object",
        "required": [
          "success",
          "query",
          "total",
          "limit",
          "offset",
          "results",
          "execution_time_ms"
        ],
        "properties": {
          "success": {
            "type": "boolean",
            "description": "Se a busca foi bem-sucedida"
          },
          "query": {
            "type": "string",
            "description": "Query executada"
          },
          "total": {
            "type": "integer",
            "description": "Total de resultados encontrados"
          },
          "limit": {
            "type": "integer",
            "description": "Limite de resultados"
          },
          "offset": {
            "type": "integer",
            "description": "Offset usado"
          },
          "results": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/DocumentResponse"
            },
            "description": "Lista de documentos encontrados ordenados por relev√¢ncia. Cada documento tem: id, title (t√≠tulo), module (m√≥dulo), content_preview (resumo do conte√∫do at√© 200 caracteres), url (link original), score (0-100 onde 100=mais relevante). Use esses dados para responder √† pergunta do usu√°rio de forma clara e completa."
          },
          "execution_time_ms": {
            "type": "number",
            "format": "float",
            "description": "Tempo de execu√ß√£o da busca em milissegundos"
          }
        }
      },
      "ModuleInfo": {
        "type": "object",
        "required": [
          "name",
          "doc_count"
        ],
        "properties": {
          "name": {
            "type": "string",
            "description": "Nome do m√≥dulo"
          },
          "doc_count": {
            "type": "integer",
            "description": "N√∫mero de documentos do m√≥dulo"
          },
          "description": {
            "type": "string",
            "nullable": true,
            "description": "Descri√ß√£o do m√≥dulo"
          }
        }
      },
      "ModulesResponse": {
        "type": "object",
        "required": [
          "success",
          "total_modules",
          "modules"
        ],
        "properties": {
          "success": {
            "type": "boolean",
            "description": "Se a opera√ß√£o foi bem-sucedida"
          },
          "total_modules": {
            "type": "integer",
            "description": "Total de m√≥dulos"
          },
          "modules": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/ModuleInfo"
            },
            "description": "Lista de m√≥dulos"
          }
        }
      },
      "ModuleDocsResponse": {
        "type": "object",
        "required": [
          "success",
          "module",
          "total_docs",
          "documents"
        ],
        "properties": {
          "success": {
            "type": "boolean",
            "description": "Se a opera√ß√£o foi bem-sucedida"
          },
          "module": {
            "type": "string",
            "description": "Nome do m√≥dulo"
          },
          "total_docs": {
            "type": "integer",
            "description": "Total de documentos no m√≥dulo"
          },
          "documents": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/DocumentResponse"
            },
            "description": "Lista de documentos do m√≥dulo"
          }
        }
      },
      "StatsResponse": {
        "type": "object",
        "required": [
          "success",
          "total_documents",
          "total_modules",
          "modules",
          "index_name"
        ],
        "properties": {
          "success": {
            "type": "boolean",
            "description": "Se a opera√ß√£o foi bem-sucedida"
          },
          "total_documents": {
            "type": "integer",
            "description": "Total de documentos indexados"
          },
          "total_modules": {
            "type": "integer",
            "description": "Total de m√≥dulos"
          },
          "modules": {
            "type": "object",
            "description": "Contagem de documentos por m√≥dulo",
            "additionalProperties": {
              "type": "integer"
            }
          },
          "index_name": {
            "type": "string",
            "description": "Nome do √≠ndice"
          },
          "meilisearch_version": {
            "type": "string",
            "nullable": true,
            "description": "Vers√£o do Meilisearch"
          },
          "last_indexed": {
            "type": "string",
            "nullable": true,
            "description": "√öltima data de indexa√ß√£o"
          }
        }
      },
      "HealthResponse": {
        "type": "object",
        "required": [
          "status",
          "timestamp",
          "version",
          "meilisearch"
        ],
        "properties": {
          "status": {
            "type": "string",
            "enum": [
              "healthy",
              "unhealthy"
            ],
            "description": "Status do servi√ßo (healthy/unhealthy)"
          },
          "timestamp": {
            "type": "string",
            "format": "date-time",
            "description": "Timestamp do check"
          },
          "version": {
            "type": "string",
            "description": "Vers√£o do MCP Server"
          },
          "meilisearch": {
            "type": "object",
            "description": "Status do Meilisearch",
            "properties": {
              "url": {
                "type": "string",
                "description": "URL do Meilisearch"
              },
              "healthy": {
                "type": "boolean",
                "description": "Se o Meilisearch est√° saud√°vel"
              }
            }
          }
        }
      }
    }
  }
}
